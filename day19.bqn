âŸ¨ Split, lf, ToNats âŸ© â† â€¢Import "bqn-libs/strings.bqn"

i â† Â¯1â†“â€¢file.Chars "input19.txt"

workflowsâ€¿parts â† lf SplitÂ¨ (2â¥Šlf)Split i
[id,wf] â† â‰>('{'Split Â¯1â†“âŠ¢)Â¨ workflows
parts â†© ToNatsÂ¨ parts
_KF â† {fsâŠ‘ËœâŠ‘idâŠ<ğ•—}

IVSplit â† {vğ•Šcâ€¿d: âŒ½âŸd < {ğ•©âŒ¾(câŠ¸âŠ)ğ•¨}Â¨Â·âŒ½âŒ¾âŠ‘ (v+d)âˆ¾Â¨câŠâŠ¢}
ParseWF â† {
  râ€¿def â† Â¯1(â†“â‹ˆâŠ‘)','Split ğ•©
  [cond,dest] â† â‰>':'SplitÂ¨r
  r â†© (âŠ‘âˆ˜ToNats IVSplit 4|"xmas<>"âŠ2â†‘âŠ¢)Â¨cond
  {âˆ§Â´<Â´Ë˜ğ•©? def _KF ğ•©{râ€¿dğ•Šğ•©: d _KFâŠ¸âŠ¢Â´Rğ•©}ËâŒ½ â‰râ‰dest ; @ }
}

accept â† âŸ¨âŸ© â‹„ A â† {acceptâˆ¾â†©<ğ•©} â‹„ idâˆ¾â†©<"A"
reject â† âŸ¨âŸ© â‹„ R â† {rejectâˆ¾â†©<ğ•©} â‹„ idâˆ¾â†©<"R"
fs â† Aâ€¿R âˆ¾Ëœ ParseWFÂ¨wf

"in"_KF 4â€¿2â¥Š1â€¿4001

â€¢Show +Â´âˆ¾ parts Ã— âˆ¨Ëâˆ§Â´Â¨ 1= accept â‹Ë˜âŒœ parts
â€¢Show +Â´(Ã—Â´-ËœÂ´Ë˜)Â¨accept
