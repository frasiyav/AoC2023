âŸ¨ Split, lf âŸ© â† â€¢Import "bqn-libs/strings.bqn"
While â† {ğ•©â€¢_while_ğ•¨@}Â´

i â† â€¢file.Chars "input13.txt"

p â† (>lf SplitâŠ¢)Â¨ (2â¥Šlf) Split Â¯1â†“i

P1 â† { ğ•Š m:
  n â† â‰ m
  p â† 0â€¿1 â‹„ PNext â† {ğ•Š: p+â†©Â¯1â€¿1}
  refl â† 1 â‹„ RNext â† {ğ•Š: pâ†©0â€¿1+refl â‹„ refl+â†©1}
  found â† 0

  While {ğ•Š:(Ã—found) Â¬âŠ¸âˆ§ refl<n}â€¿{ğ•Š:
    âˆ¨Â´1â‰ 0â€¿nâ‹p? foundâ†©refl;
    â‰¡ËpâŠm? PNext @;
    RNext @
  }
  found
}

P2 â† { ğ•Š m:
  n â† â‰ m
  p â† 0â€¿1 â‹„ PNext â† {ğ•Š: p+â†©Â¯1â€¿1}
  refl â† 1 â‹„ RNext â† {ğ•Š: pâ†©0â€¿1+refl â‹„ refl+â†©1 â‹„ smudgedâ†©0}
  found â† 0
  smudged â†0

  While {ğ•Š: (Ã—found) Â¬âŠ¸âˆ§ refl<n}â€¿{ğ•Š:
    âˆ¨Â´1â‰ 0â€¿nâ‹p?
      { smudged? foundâ†©refl ; RNext@ }
  ;
    {
      smudged?
        { â‰¡ËpâŠm ? PNext @; RNext @}
    ;
      1â‰¡+Â´â‰ ËpâŠm?
        PNext @
        smudgedâ†©1
    ;
      â‰¡ËpâŠm? PNext @
    ;
      RNext@
    }
  }
  found
}
â€¢Show {+Â´(+Â´100â€¿1Ã—Â·ğ•Â¨â‹ˆâŸœâ‰)Â¨p}Â¨p1â€¿p2
