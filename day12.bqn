âŸ¨ Split, ToNats âŸ© â† â€¢Import "bqn-libs/strings.bqn"
i â† â€¢file.Lines "input12.txt"

[s,g]â†â‰>' 'SplitÂ¨i
s ".#?"âŠ¸âŠÂ¨â†©
g ToNatsÂ¨â†©

_Memoi_ â† {ğ”½{ğ•©.Hasâ—¶âŸ¨(âŠ¢âŠ£ğ•©.Set)âŸœğ”½,ğ•©.GetâŸ©}â€¢HashMapÂ´ğ•˜}

Solve â† {ğ•Šsâ€¿g:
  m â† â‰¢ v â† â‰ s {
    Â¬âˆ¨Ë[
      (âŠ¢<ğ•©+â†•)â‰ ğ•¨
      ğ•© > (+âŸœ1 Ã— 0âŠ¸â‰ )`âŒ¾âŒ½ğ•¨
      ((ğ•©â¥Š0)âŠ¸Â«âˆ¨â—‹(1âŠ¸=)Â»)ğ•¨
    ]
  }â‰1â€¿0 g

  l â† gâŒˆÂ´âŠ¸+1+â‰ s
  base â† Â¬(lâ†‘(âˆ¨Â´Â»)Â»âˆ¨`âŒ¾âŒ½)1=s

  F â† {
    sâ‰ âŠ¸â‰¤âŠ‘ğ•©? 0;
    iâ€¿jâ†ğ•©
    (iâŠ‘s)â—¶âŸ¨
      F 1â€¿0+âŠ¢
      (ğ•©âŠ‘v)â—¶âŸ¨0,FâŸ© (1+jâŠ‘g)â€¿1+ğ•©
      (ğ•©âŠ‘v)â—¶âŸ¨F,F+Â·F(jâŠ‘g)â€¿1+âŠ¢âŸ© 1â€¿0+ğ•©
    âŸ©ğ•©
  }_Memoi_ (<Ë˜â‰>â†•âˆ˜â‰ âŠ¸(â‹ˆâŸœ(â‰ g)âŠ¸â‹ˆÂ¨)base)

  F âŸ¨0,0âŸ©
}

â€¢Show +Â´SolveË˜â‰[s,g]
s (âˆ¾âŸœ2âŠ¸âˆ¾Â´5â¥Š<)Â¨â†©
g (âˆ¾5â¥Š<)Â¨â†©
â€¢Show +Â´SolveË˜â‰[s,g]
